<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®ˆæ ªå¾…å…” - Chengyu en 3D VR</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Interfaz de Usuario -->
    <div id="ui-container" class="ui-container">
        <div class="header">
            <h1>å®ˆæ ªå¾…å…”</h1>
            <p class="subtitle">ShÇ’u ZhÅ« DÃ i TÃ¹ - "Guardar el tocÃ³n esperando conejos"</p>
        </div>
        
        <div class="info-panel">
            <div class="chengyu-info">
                <h3>Sobre este Chengyu</h3>
                <p>Este chengyu proviene del Huainanzi (æ·®å—å­), un texto taoÃ­sta del siglo II a.C. La historia enseÃ±a sobre los peligros de depender de la suerte en lugar del trabajo duro y la planificaciÃ³n.</p>
                <div class="moral">
                    <strong>Moraleja:</strong> No confÃ­es en golpes de suerte; el Ã©xito viene del esfuerzo constante.
                </div>
            </div>
        </div>
        
        <!-- Controles de Audio Mejorados -->
        <div class="audio-controls">
            <button id="mute-btn" class="btn btn-audio">ğŸ”Š Audio</button>
            <input type="range" id="volume-slider" min="0" max="100" value="30" class="volume-slider">
            <span id="volume-display">30%</span>
        </div>
        
        <div class="controls">
            <button id="restart-btn" class="btn btn-primary">Reiniciar Historia</button>
            <button id="camera-btn" class="btn btn-secondary">Cambiar Vista</button>
            <button id="vr-btn" class="btn btn-vr">Entrar en VR</button>
        </div>
        
        <div class="progress-indicator">
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
            </div>
            <div class="scene-labels">
                <span class="scene-label active" data-scene="0">Trabajo</span>
                <span class="scene-label" data-scene="1">Suerte</span>
                <span class="scene-label" data-scene="2">Espera</span>
                <span class="scene-label" data-scene="3">Ruina</span>
            </div>
        </div>
        
        <div id="story-text" class="story-text">
            <p id="current-story">Un granjero trabajaba diligentemente en sus campos cuando un conejo corriÃ³ hacia un tocÃ³n de Ã¡rbol y muriÃ³ al impactar...</p>
        </div>
    </div>

    <!-- Escena A-Frame -->
    <a-scene 
        id="scene" 
        embedded 
        style="height: 70vh; width: 100%;"
        vr-mode-ui="enabled: true"
        device-orientation-permission-ui="enabled: false">
        
        <!-- Assets sin audio estridente -->
        <a-assets>
            <!-- Solo mantenemos un audio ambiente muy suave -->
            <audio id="gentle-ambient" preload="auto" loop volume="0.1">
                <!-- Sin src para eliminar el audio problemÃ¡tico -->
            </audio>
        </a-assets>

        <!-- IluminaciÃ³n -->
        <a-light type="ambient" color="#404040" intensity="0.4"></a-light>
        <a-light type="directional" position="2 4 2" color="#ffffff" intensity="0.8"></a-light>
        
        <!-- Cielo y Entorno -->
        <a-sky color="#87CEEB"></a-sky>
        
        <!-- Suelo -->
        <a-plane 
            position="0 0 0" 
            rotation="-90 0 0" 
            width="20" 
            height="20" 
            color="#8FBC8F" 
            shadow="receive: true">
        </a-plane>
        
        <!-- MontaÃ±as de fondo -->
        <a-triangle position="-8 2 -8" scale="3 3 1" color="#556B2F"></a-triangle>
        <a-triangle position="5 1.5 -7" scale="2.5 2.5 1" color="#6B8E23"></a-triangle>
        <a-triangle position="0 1.8 -9" scale="4 4 1" color="#808000"></a-triangle>

        <!-- Campo de cultivo -->
        <a-entity id="farm-field">
            <a-box position="-5 0.1 -2" width="6" height="0.2" depth="4" color="#8B4513"></a-box>
            <!-- Surcos en el campo -->
            <a-box position="-6 0.11 -1" width="0.3" height="0.05" depth="3" color="#654321"></a-box>
            <a-box position="-5 0.11 -1" width="0.3" height="0.05" depth="3" color="#654321"></a-box>
            <a-box position="-4 0.11 -1" width="0.3" height="0.05" depth="3" color="#654321"></a-box>
            <a-box position="-3 0.11 -1" width="0.3" height="0.05" depth="3" color="#654321"></a-box>
        </a-entity>

        <!-- Maleza (inicialmente oculta) -->
        <a-entity id="weeds" visible="false">
            <a-cone position="-6 0.3 -1" radius-bottom="0.1" height="0.4" color="#228B22"></a-cone>
            <a-cone position="-5.5 0.25 -0.5" radius-bottom="0.08" height="0.3" color="#32CD32"></a-cone>
            <a-cone position="-4.5 0.35 -1.5" radius-bottom="0.12" height="0.5" color="#228B22"></a-cone>
            <a-cone position="-3.5 0.3 -0.8" radius-bottom="0.09" height="0.4" color="#32CD32"></a-cone>
            <a-cone position="-5 0.28 -2" radius-bottom="0.1" height="0.35" color="#228B22"></a-cone>
        </a-entity>

        <!-- TocÃ³n del Ã¡rbol (elemento central) -->
        <a-entity id="tree-stump" position="2 0 -3">
            <a-cylinder position="0 0.5 0" radius="0.8" height="1" color="#8B4513" shadow="cast: true"></a-cylinder>
            <a-ring position="0 1.01 0" radius-inner="0.1" radius-outer="0.7" color="#654321" rotation="-90 0 0"></a-ring>
            <a-ring position="0 1.01 0" radius-inner="0.3" radius-outer="0.5" color="#8B4513" rotation="-90 0 0"></a-ring>
            <a-box position="0.6 0.3 0" width="0.1" height="0.4" depth="0.1" color="#654321"></a-box>
            <a-box position="-0.5 0.6 0.3" width="0.1" height="0.3" depth="0.1" color="#654321"></a-box>
        </a-entity>

        <!-- Granjero -->
        <a-entity id="farmer" position="-5 0 -1" story-character>
            <a-cylinder position="0 1.2 0" radius="0.3" height="0.8" color="#8B4513"></a-cylinder>
            <a-sphere position="0 1.8 0" radius="0.25" color="#D2B48C"></a-sphere>
            <a-cone position="0 2.1 0" radius-bottom="0.4" radius-top="0.1" height="0.3" color="#8B4513"></a-cone>
            <a-sphere position="-0.4 1.4 0" radius="0.1" color="#D2B48C"></a-sphere>
            <a-cylinder position="-0.6 1.1 0" radius="0.08" height="0.4" color="#D2B48C" rotation="0 0 -30"></a-cylinder>
            <a-sphere position="0.4 1.4 0" radius="0.1" color="#D2B48C"></a-sphere>
            <a-cylinder position="0.6 1.1 0" radius="0.08" height="0.4" color="#D2B48C" rotation="0 0 30"></a-cylinder>
            <a-cylinder position="-0.15 0.4 0" radius="0.1" height="0.8" color="#654321"></a-cylinder>
            <a-cylinder position="0.15 0.4 0" radius="0.1" height="0.8" color="#654321"></a-cylinder>
            <a-cylinder id="farming-tool" position="0.8 1.2 0" radius="0.05" height="1.5" color="#8B4513" rotation="0 0 45"></a-cylinder>
        </a-entity>

        <!-- Conejo -->
        <a-entity id="rabbit" position="8 0.2 -3" rabbit-controller>
            <a-sphere position="0 0.3 0" radius="0.3" color="#FFFFFF" scale="1.2 0.8 1"></a-sphere>
            <a-sphere position="0.3 0.4 0" radius="0.2" color="#FFFFFF"></a-sphere>
            <a-sphere position="0.4 0.65 -0.1" radius="0.08" color="#FFFFFF" scale="0.5 2 0.5"></a-sphere>
            <a-sphere position="0.4 0.65 0.1" radius="0.08" color="#FFFFFF" scale="0.5 2 0.5"></a-sphere>
            <a-sphere position="0.4 0.6 -0.1" radius="0.03" color="#FFB6C1" scale="0.5 1.5 0.5"></a-sphere>
            <a-sphere position="0.4 0.6 0.1" radius="0.03" color="#FFB6C1" scale="0.5 1.5 0.5"></a-sphere>
            <a-sphere position="0.45 0.45 -0.08" radius="0.03" color="#000000"></a-sphere>
            <a-sphere position="0.45 0.45 0.08" radius="0.03" color="#000000"></a-sphere>
            <a-sphere position="0.5 0.4 0" radius="0.02" color="#FFB6C1"></a-sphere>
            <a-sphere position="0.1 0.1 -0.15" radius="0.08" color="#FFFFFF"></a-sphere>
            <a-sphere position="0.1 0.1 0.15" radius="0.08" color="#FFFFFF"></a-sphere>
            <a-sphere position="-0.1 0.1 -0.15" radius="0.08" color="#FFFFFF"></a-sphere>
            <a-sphere position="-0.1 0.1 0.15" radius="0.08" color="#FFFFFF"></a-sphere>
            <a-sphere position="-0.3 0.35 0" radius="0.1" color="#FFFFFF" scale="0.6 0.6 0.6"></a-sphere>
        </a-entity>

        <!-- Conejo muerto (inicialmente oculto) -->
        <a-entity id="dead-rabbit" position="2.5 0 -3" visible="false">
            <a-sphere position="0 0.1 0" radius="0.3" color="#F5F5F5" scale="1.2 0.8 1" rotation="0 0 90"></a-sphere>
            <a-sphere position="0.3 0.15 0" radius="0.2" color="#F5F5F5" rotation="0 0 45"></a-sphere>
            <a-sphere position="0.5 0.2 -0.1" radius="0.08" color="#F5F5F5" scale="0.5 2 0.5" rotation="45 0 0"></a-sphere>
            <a-sphere position="0.5 0.2 0.1" radius="0.08" color="#F5F5F5" scale="0.5 2 0.5" rotation="45 0 0"></a-sphere>
        </a-entity>

        <!-- Efectos visuales silenciosos -->
        <a-entity id="dust-particles" position="2 0.5 -3" visible="false">
            <a-sphere radius="0.02" color="#D2B48C" opacity="0.6"></a-sphere>
            <a-sphere radius="0.015" color="#DEB887" opacity="0.5" position="0.1 0.1 0.1"></a-sphere>
            <a-sphere radius="0.02" color="#F4A460" opacity="0.4" position="-0.1 0.05 -0.1"></a-sphere>
            <a-sphere radius="0.01" color="#D2B48C" opacity="0.6" position="0.05 -0.05 0.15"></a-sphere>
        </a-entity>

        <!-- CÃ¡mara -->
        <a-entity id="camera-rig" position="0 1.6 5">
            <a-camera id="main-camera" look-controls="enabled: true" wasd-controls="enabled: true"></a-camera>
        </a-entity>
    </a-scene>

    <script src="app.js"></script>
</body>
</html>
